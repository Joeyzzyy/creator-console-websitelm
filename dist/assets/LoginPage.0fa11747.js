import{_ as I,r as S,o as M,a as p,c as b,b as t,w as a,F as R,d as g,e as h,f as n,t as u,g as k,h as _,i as c,j as F,k as P,n as C}from"./index.635c445a.js";const T={name:"LoginPage",data(){return localStorage.getItem("intelickIsLoggedIn")&&this.$router.push("/"),{form:{email:"",password:""},rememberMe:!1,loading:!1,isLogin:!0,isForgotPassword:!1,registerForm:{email:"",code:"",password:"",confirmPassword:""},cooldown:0,cooldownTimer:null,resetForm:{email:"",code:"",newPassword:"",confirmPassword:""},showSetPasswordModal:!1,setPasswordLoading:!1,setPasswordForm:{newPassword:"",confirmPassword:""}}},setup(){S(0);const r=S(null);M(()=>{r.value&&clearInterval(r.value)})},created(){const r=localStorage.getItem("rememberedCredentials");if(r){const e=this.decodeCredentials(r);this.form.email=e.email,this.form.password=e.password,this.rememberMe=!0}},computed:{forgotPasswordStrength(){const r=this.isForgotPassword?this.resetForm.newPassword:this.registerForm.password;if(!r)return"";let e=0;switch(r.length>=8&&e++,/[A-Z]/.test(r)&&e++,/[a-z]/.test(r)&&e++,/\d/.test(r)&&e++,e){case 4:return"Strong";case 3:return"Medium";default:return"Weak"}},passwordStrength(){const r=this.registerForm.password;if(!r)return"";let e=0;switch(r.length>=8&&e++,/[A-Z]/.test(r)&&e++,/[a-z]/.test(r)&&e++,/\d/.test(r)&&e++,e){case 4:return"Strong";case 3:return"Medium";default:return"Weak"}},passwordStrengthClass(){return{Strong:"strength-strong",Medium:"strength-medium",Weak:"strength-weak"}[this.passwordStrength]||""},forgotPasswordStrengthClass(){return{Strong:"strength-strong",Medium:"strength-medium",Weak:"strength-weak"}[this.forgotPasswordStrength]||""},setPasswordStrength(){const r=this.setPasswordForm.newPassword;if(!r)return"";let e=0;switch(r.length>=8&&e++,/[A-Z]/.test(r)&&e++,/[a-z]/.test(r)&&e++,/\d/.test(r)&&e++,e){case 4:return"\u5F3A";case 3:return"\u4E2D";default:return"\u5F31"}},setPasswordStrengthClass(){return{\u5F3A:"strength-strong",\u4E2D:"strength-medium",\u5F31:"strength-weak"}[this.setPasswordStrength]||""}},methods:{async handleGoogleLogin(){try{const r=await p.googleLogin();r&&r.code===200?window.location.href=r.data:this.$notification.success({message:"Error",description:"Failed to get login url from Google"})}catch(r){this.$notification.error({message:"Error",description:r.message||"Failed to send verification code"})}},showForgotPassword(){this.isForgotPassword=!0,this.isLogin=!1},backToLogin(){this.isForgotPassword=!1,this.isLogin=!0,this.resetForm={email:"",code:"",newPassword:"",confirmPassword:""}},async sendResetCode(){if(!this.resetForm.email){this.$notification.error({message:"Error",description:"Please input your email first"});return}try{await p.sendEmailCode(this.resetForm.email,"forgot_password"),this.cooldown=60,this.cooldownTimer=setInterval(()=>{this.cooldown--,this.cooldown<=0&&clearInterval(this.cooldownTimer)},1e3),this.$notification.success({message:"Success",description:"Verification code has been sent to your email"})}catch(r){this.$notification.error({message:"Error",description:r.message||"Failed to send verification code"})}},validateConfirmResetPassword(r,e){return e?e!==this.resetForm.newPassword?Promise.reject("The two passwords do not match!"):Promise.resolve():Promise.reject("Please confirm your password!")},async handleResetPassword(){const{email:r,code:e,newPassword:l,confirmPassword:m}=this.resetForm;if(!r||!e||!l||!m){this.$notification.error({message:"Error",description:"Please fill in all fields"});return}this.loading=!0;try{const s=await p.resetPassword({email:r,code:e,newPassword:l,confirmPassword:m});s&&s.code===200&&(this.$notification.success({message:"Success",description:"Password reset successful, please use the new password to log in"}),this.backToLogin())}catch(s){this.$notification.error({message:"Error",description:s.message||"Password reset failed"})}finally{this.loading=!1}},encodeCredentials(r){return btoa(JSON.stringify(r))},decodeCredentials(r){return JSON.parse(atob(r))},async handleLogin(){var l,m;const{email:r,password:e}=this.form;if(!r||!e){this.$notification.error({message:"Login Error",description:"Please enter email and password"});return}this.loading=!0;try{const s=await p.login(r,e);if(s){if(s.code===401&&s.message==="Password incorrect"){this.$notification.error({message:"Login Failed",description:"Password incorrect, please check your email and password"});return}if(s.code===404&&s.message==="User not find"){this.$notification.error({message:"Login Failed",description:"User not found, please register first"});return}if(localStorage.clear(),localStorage.setItem("intelickIsLoggedIn","true"),localStorage.setItem("accessToken",s.accessToken),s.data.customerId&&(localStorage.setItem("currentCustomerEmail",s.data.email),localStorage.setItem("currentCustomerId",s.data.customerId)),this.rememberMe){const o={email:r,password:e};localStorage.setItem("rememberedCredentials",this.encodeCredentials(o))}else localStorage.removeItem("rememberedCredentials");s.data.firstLogin?(this.showSetPasswordModal=!0,localStorage.setItem("accessToken",s.accessToken)):this.$router.push("/dashboard")}}catch(s){console.error("Login failed:",s),this.$notification.error({message:"Login Failed",description:((m=(l=s.response)==null?void 0:l.data)==null?void 0:m.message)||"Please check your email and password"})}finally{this.loading=!1}},toggleForm(){this.isLogin=!this.isLogin,this.loading=!1},validatePassword(r,e){const l=/^(?=.*[A-Z])(?=.*[a-z])(?=.*\d).{8,}$/;return e?l.test(e)?Promise.resolve():Promise.reject("Password must contain at least one uppercase letter, one lowercase letter, and one number"):Promise.reject("Please input your password!")},validateConfirmPassword(r,e){return e?e!==this.registerForm.passwsord?Promise.reject("The two passwords do not match!"):Promise.resolve():Promise.reject("Please confirm your password!")},async sendCode(){if(!this.registerForm.email){this.$notification.error({message:"Error",description:"Please enter your email first"});return}try{if((await p.sendEmailCode(this.registerForm.email,"register")).code===1001){this.$notification.error({message:"Error",description:"This email is already registered"});return}this.cooldown=60,this.cooldownTimer=setInterval(()=>{this.cooldown--,this.cooldown<=0&&clearInterval(this.cooldownTimer)},1e3),this.$notification.success({message:"Success",description:"Verification code has been sent to your email"})}catch(r){this.$notification.error({message:"Error",description:r.message||"Failed to send verification code"})}},async handleRegister(){const{email:r,code:e,password:l,confirmPassword:m}=this.registerForm;if(!r||!e||!l||!m){this.$notification.error({message:"Error",description:"Please fill in all fields"});return}if(!/^(?=.*[A-Z])(?=.*[a-z])(?=.*\d).{8,}$/.test(l)){this.$notification.error({message:"Error",description:"Password must contain at least one uppercase letter, one lowercase letter, one number, and be at least 8 characters long"});return}if(l!==m){this.$notification.error({message:"Error",description:"Passwords do not match"});return}this.loading=!0;try{const o=await p.register({email:r,code:e,password:l});o&&o.code===200?(this.$notification.success({message:"Success",description:"Registration successful! Please login."}),this.registerForm={email:"",code:"",password:"",confirmPassword:""},this.isLogin=!0):o&&o.code===400&&o.message=="Invalid verification code"?this.$notification.error({message:"Error",description:"The verification code is incorrect. Please check and try again."}):o&&o.code===400&&o.message=="email already exists"&&this.$notification.error({message:"Error",description:"Email already registered"})}catch(o){this.$notification.error({message:"Error",description:o.message||"Registration failed"})}finally{this.loading=!1}},validateConfirmSetPassword(r,e){return e?e!==this.setPasswordForm.newPassword?Promise.reject("\u4E24\u6B21\u8F93\u5165\u7684\u5BC6\u7801\u4E0D\u4E00\u81F4!"):Promise.resolve():Promise.reject("\u8BF7\u786E\u8BA4\u5BC6\u7801!")},async handleSetPassword(){const{newPassword:r,confirmPassword:e}=this.setPasswordForm;if(!r||!e){this.$notification.error({message:"\u9519\u8BEF",description:"\u8BF7\u586B\u5199\u6240\u6709\u5B57\u6BB5"});return}this.setPasswordLoading=!0;try{const l=await p.changePassword({currentPassword:"",newPassword:r,confirmPassword:e});l&&l.code===200&&(this.$notification.success({message:"\u6210\u529F",description:"\u5BC6\u7801\u8BBE\u7F6E\u6210\u529F"}),this.showSetPasswordModal=!1,this.$router.push("/dashboard"))}catch(l){this.$notification.error({message:"\u9519\u8BEF",description:l.message||"\u5BC6\u7801\u8BBE\u7F6E\u5931\u8D25"})}finally{this.setPasswordLoading=!1}}},beforeUnmount(){this.cooldownTimer&&clearInterval(this.cooldownTimer)}},U={class:"login-container",style:{width:"400px",padding:"40px",background:"rgba(255, 255, 255, 0.95)","border-radius":"24px","box-shadow":"0 8px 32px rgba(108, 152, 255, 0.15)",border:"1px solid rgba(108, 152, 255, 0.2)"}},j={class:"logo-section"},q={class:"subtitle"},A={style:{display:"flex","justify-content":"space-between","align-items":"center"}},N={class:"register-prompt"},V={class:"email-verify-group"},B={key:0,class:"password-strength"},G={class:"register-prompt"},K={class:"email-verify-group"},W={key:0,class:"password-strength"},Z={class:"register-prompt"},D={key:0,class:"password-strength"};function J(r,e,l,m,s,o){const v=g("a-input"),d=g("a-form-item"),w=g("a-input-password"),L=g("a-checkbox"),f=g("a-button"),y=g("a-form"),E=g("a-layout-content"),x=g("a-layout"),z=g("a-modal");return h(),b(R,null,[t(x,{style:{height:"100vh",background:"linear-gradient(135deg, #E8F0FF 0%, #C7D9FF 100%)"}},{default:a(()=>[t(E,{style:{display:"flex","align-items":"center","justify-content":"center",height:"100%",padding:"20px"}},{default:a(()=>[n("div",U,[n("div",j,[e[18]||(e[18]=n("h2",{class:"app-title"},[n("span",{class:"website-text"},"Website"),n("span",{class:"lm-text"},"LM"),n("span",{class:"title-emoji"},"\u2726")],-1)),n("p",q,u(s.isForgotPassword?"Reset Your Account Password":s.isLogin?"Create Content At Ease":"Get An Account For Start"),1)]),s.isLogin?(h(),k(y,{key:0,layout:"vertical",onSubmit:F(o.handleLogin,["prevent"])},{default:a(()=>[t(d,{label:"Email"},{default:a(()=>[t(v,{value:s.form.email,"onUpdate:value":e[0]||(e[0]=i=>s.form.email=i),placeholder:"Enter your email",size:"large",class:"custom-input",onKeydown:_(o.handleLogin,["enter"])},null,8,["value","onKeydown"])]),_:1}),t(d,{label:"Password"},{default:a(()=>[t(w,{value:s.form.password,"onUpdate:value":e[1]||(e[1]=i=>s.form.password=i),placeholder:"Enter your password",size:"large",class:"custom-input",onKeydown:_(o.handleLogin,["enter"])},null,8,["value","onKeydown"])]),_:1}),t(d,null,{default:a(()=>[n("div",A,[t(L,{checked:s.rememberMe,"onUpdate:checked":e[2]||(e[2]=i=>s.rememberMe=i)},{default:a(()=>e[19]||(e[19]=[c("Remember me")])),_:1},8,["checked"]),n("a",{onClick:e[3]||(e[3]=(...i)=>o.showForgotPassword&&o.showForgotPassword(...i)),class:"forgot-password-link"},"Forgot Password?")])]),_:1}),t(d,null,{default:a(()=>[t(f,{type:"primary",block:"",size:"large",onClick:o.handleLogin,class:"login-button",loading:s.loading},{default:a(()=>[c(u(s.loading?"Logging in...":"Login"),1)]),_:1},8,["onClick","loading"])]),_:1}),e[22]||(e[22]=n("div",{class:"divider"},[n("span",{class:"divider-text"},"or")],-1)),t(f,{block:"",size:"large",class:"google-login-button",onClick:o.handleGoogleLogin},{default:a(()=>e[20]||(e[20]=[n("img",{src:"https://www.google.com/favicon.ico",alt:"Google",class:"google-icon"},null,-1),c(" Continue with Google ")])),_:1},8,["onClick"]),n("div",N,[e[21]||(e[21]=c(" Don't have an account? ")),n("a",{onClick:e[4]||(e[4]=(...i)=>o.toggleForm&&o.toggleForm(...i))},"Register now")])]),_:1},8,["onSubmit"])):P("",!0),s.isForgotPassword?(h(),k(y,{key:1,layout:"vertical",onSubmit:F(o.handleResetPassword,["prevent"])},{default:a(()=>[t(d,{label:"Email",rules:[{required:!0,message:"Please input your email!"},{type:"email",message:"Please input a valid email!"}]},{default:a(()=>[n("div",V,[t(v,{value:s.resetForm.email,"onUpdate:value":e[5]||(e[5]=i=>s.resetForm.email=i),placeholder:"Please input your email",size:"large",class:"custom-input"},null,8,["value"]),t(f,{onClick:o.sendResetCode,disabled:s.cooldown>0,size:"large",class:"verify-code-btn"},{default:a(()=>[c(u(s.cooldown>0?`${s.cooldown}s`:"Send"),1)]),_:1},8,["onClick","disabled"])])]),_:1}),t(d,{label:"Code",rules:[{required:!0,message:"Please input verification code!"}]},{default:a(()=>[t(v,{value:s.resetForm.code,"onUpdate:value":e[6]||(e[6]=i=>s.resetForm.code=i),placeholder:"Please input verification code",size:"large",class:"custom-input"},null,8,["value"])]),_:1}),t(d,{label:"New Password",rules:[{required:!0,message:"Please input new password!"},{validator:o.validatePassword}]},{default:a(()=>[t(w,{value:s.resetForm.newPassword,"onUpdate:value":e[7]||(e[7]=i=>s.resetForm.newPassword=i),placeholder:"Please input new password",size:"large",class:"custom-input"},null,8,["value"]),s.resetForm.newPassword?(h(),b("div",B,[e[23]||(e[23]=c(" Password Strength: ")),n("span",{class:C(o.forgotPasswordStrengthClass)},u(o.forgotPasswordStrength),3)])):P("",!0)]),_:1},8,["rules"]),t(d,{label:"Confirm Password",rules:[{required:!0,message:"Please confirm your password!"},{validator:o.validateConfirmResetPassword}]},{default:a(()=>[t(w,{value:s.resetForm.confirmPassword,"onUpdate:value":e[8]||(e[8]=i=>s.resetForm.confirmPassword=i),placeholder:"Please confirm your password",size:"large",class:"custom-input"},null,8,["value"])]),_:1},8,["rules"]),t(d,null,{default:a(()=>[t(f,{type:"primary",block:"",size:"large",onClick:o.handleResetPassword,class:"login-button",loading:s.loading},{default:a(()=>[c(u(s.loading?"Resetting...":"Reset Password"),1)]),_:1},8,["onClick","loading"])]),_:1}),n("div",G,[n("a",{onClick:e[9]||(e[9]=(...i)=>o.backToLogin&&o.backToLogin(...i))},"Back to Login")])]),_:1},8,["onSubmit"])):P("",!0),!s.isLogin&&!s.isForgotPassword?(h(),k(y,{key:2,layout:"vertical",onSubmit:F(o.handleRegister,["prevent"])},{default:a(()=>[t(d,{label:"Email",rules:[{required:!0,message:"Please input your email!"},{type:"email",message:"Please input a valid email!"}]},{default:a(()=>[n("div",K,[t(v,{value:s.registerForm.email,"onUpdate:value":e[10]||(e[10]=i=>s.registerForm.email=i),placeholder:"Enter your email",size:"large",class:"custom-input"},null,8,["value"]),t(f,{onClick:o.sendCode,disabled:s.cooldown>0,size:"large",class:"verify-code-btn"},{default:a(()=>[c(u(s.cooldown>0?`${s.cooldown}s`:"Send"),1)]),_:1},8,["onClick","disabled"])])]),_:1}),t(d,{label:"Verification Code",rules:[{required:!0,message:"Please input verification code!"}]},{default:a(()=>[t(v,{value:s.registerForm.code,"onUpdate:value":e[11]||(e[11]=i=>s.registerForm.code=i),placeholder:"Enter verification code",size:"large",class:"custom-input"},null,8,["value"])]),_:1}),t(d,{label:"Password",rules:[{required:!0,message:"Please input your password!"},{validator:o.validatePassword}]},{default:a(()=>[t(w,{value:s.registerForm.password,"onUpdate:value":e[12]||(e[12]=i=>s.registerForm.password=i),placeholder:"Enter password",size:"large",class:"custom-input"},null,8,["value"]),s.registerForm.password?(h(),b("div",W,[e[24]||(e[24]=c(" Password Strength: ")),n("span",{class:C(o.passwordStrengthClass)},u(o.passwordStrength),3)])):P("",!0)]),_:1},8,["rules"]),t(d,{label:"Confirm Password",rules:[{required:!0,message:"Please confirm your password!"},{validator:o.validateConfirmPassword}]},{default:a(()=>[t(w,{value:s.registerForm.confirmPassword,"onUpdate:value":e[13]||(e[13]=i=>s.registerForm.confirmPassword=i),placeholder:"Confirm password",size:"large",class:"custom-input"},null,8,["value"])]),_:1},8,["rules"]),t(d,null,{default:a(()=>[t(f,{type:"primary",block:"",size:"large",onClick:o.handleRegister,class:"login-button",loading:s.loading},{default:a(()=>[c(u(s.loading?"Registering...":"Register"),1)]),_:1},8,["onClick","loading"])]),_:1}),n("div",Z,[e[25]||(e[25]=c(" Already have an account? ")),n("a",{onClick:e[14]||(e[14]=(...i)=>o.toggleForm&&o.toggleForm(...i))},"Login now")])]),_:1},8,["onSubmit"])):P("",!0)])]),_:1})]),_:1}),t(z,{visible:s.showSetPasswordModal,"onUpdate:visible":e[17]||(e[17]=i=>s.showSetPasswordModal=i),title:"\u8BBE\u7F6E\u5BC6\u7801",closable:!1,maskClosable:!1,keyboard:!1,footer:null,width:"400px"},{default:a(()=>[t(y,{layout:"vertical",onSubmit:F(o.handleSetPassword,["prevent"])},{default:a(()=>[t(d,{label:"\u65B0\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u65B0\u5BC6\u7801!"},{validator:o.validatePassword}]},{default:a(()=>[t(w,{value:s.setPasswordForm.newPassword,"onUpdate:value":e[15]||(e[15]=i=>s.setPasswordForm.newPassword=i),placeholder:"\u8BF7\u8F93\u5165\u65B0\u5BC6\u7801",size:"large",class:"custom-input"},null,8,["value"]),s.setPasswordForm.newPassword?(h(),b("div",D,[e[26]||(e[26]=c(" \u5BC6\u7801\u5F3A\u5EA6: ")),n("span",{class:C(o.setPasswordStrengthClass)},u(o.setPasswordStrength),3)])):P("",!0)]),_:1},8,["rules"]),t(d,{label:"\u786E\u8BA4\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u786E\u8BA4\u5BC6\u7801!"},{validator:o.validateConfirmSetPassword}]},{default:a(()=>[t(w,{value:s.setPasswordForm.confirmPassword,"onUpdate:value":e[16]||(e[16]=i=>s.setPasswordForm.confirmPassword=i),placeholder:"\u8BF7\u786E\u8BA4\u5BC6\u7801",size:"large",class:"custom-input"},null,8,["value"])]),_:1},8,["rules"]),t(d,null,{default:a(()=>[t(f,{type:"primary",block:"",size:"large",onClick:o.handleSetPassword,class:"login-button",loading:s.setPasswordLoading},{default:a(()=>[c(u(s.setPasswordLoading?"\u8BBE\u7F6E\u4E2D...":"\u8BBE\u7F6E\u5BC6\u7801"),1)]),_:1},8,["onClick","loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["visible"])],64)}const Y=I(T,[["render",J],["__scopeId","data-v-a9953758"]]);export{Y as default};
